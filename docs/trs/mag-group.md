在本节中，我们讨论与时间反演对称性高度相关的磁空间群（Magnetic Space Group）的概念。
我们首先先忽略掉费米子的自旋部分的作用，考虑原始的空间群与时间反演组合后得到的磁空间群。
这部分的讨论适用于玻色子系统，或者自旋轨道耦合可以忽略的费米子系统。
之后，我们再考虑磁空间群对应的双群结构，即双磁空间群。
这部分的讨论适用于具有自旋轨道耦合的费米子系统。

在非磁性的晶体中实际上都是存在时间反演不变性的。
因此，如果一个晶体的空间群是$SG$，那么这个晶体实际的对称性应该是$SG\times\mathbb Z_2^T$，
其中$\mathbb Z_2^T$代表由时间反演对称性$\mathcal T$生成的对称群，它的代数结构为$\mathbb Z_2$。
由于时间反演对称性与空间群操作都对易，因此二者之间是最简单的直乘关系。

在具有磁性的晶体系统中，时间反演对称性将会被磁性长程序破缺。
因此，体系剩余的对称群$SG'$是相应的顺磁态对称群群$SG\times\mathbb Z_2^T$的一个子群。
这个剩余的对称群$SG'$就是一个磁空间群。
在最简单的情形下，这个磁性长程序仅仅破缺了时间反演对称性，而保留了$SG$中所有的空间群对称性。
这时剩下的对称群就是$SG'=SG$。
（在下文中我们会看到，这种情形在文献中被称为“第一类”磁空间群。）
在更一般的情形下，磁性长程序除了时间反演对称性之外，还会破缺一些空间对称性。
此时，磁性长程序往往会保留一些时间反演对称性与空间对称性的组合操作。
这是因为时间反演对称性会逆转磁矩，因此会把磁性长程序的磁矩全部翻转；
而一些空间对称性也会将磁性序的磁矩全部翻转。
由此，二者的组合恰好可以保持磁性序不变。
作为一个例子，可以参考图??中的一个正方格子上的反铁磁尼尔（Néel）态：
为简单起见，我们只考虑正方晶格上的一部分对称性操作。
如前所述，时间反演操作会翻转所有自旋。
同时，正方形中心的四重旋转操作$c_4$会将一个向上的自旋转到向下的自旋的位置，因此也会翻转所有自旋。
所以，二者的复合操作$c_4\mathcal T$就是剩余对称群$SG'$中的一个元素。
类似地，读者可以自行检查，平移操作和时间反演的复合操作也是$SG'$中的一个元素。
这种更一般的磁空间群构成了一种新的对称群结构，也是本节的讨论重点。

## 磁空间群的分类与术语约定

磁空间群按照时间反演对称性和空间对称性之间的关系可以分成如下四类，其中我们将重点讨论第三类和第四类。

1. 第一类磁空间群

第一类磁空间群只包含幺正的对称性操作，不包含反幺正的（即涉及时间反演的）对称性操作。
因此，第一类磁空间群一共有230种，对应于不考虑时间反演对称性的230种空间群。
如前所述，这类磁空间群描述的晶体对称性就是$SG$，其顺磁相的对称群为$SG\times\mathbb Z_2^T$。
其磁性长程序破缺了时间反演对称性，但是保留了所有的空间群对称性；也就是说它的磁矩分布在所有的空间群对称操作下都是不变的。
因此，这里磁性长程序的对称性破缺方式为$SG\times\mathbb Z_2^T\rightarrow SG$。
第一类磁空间群的群结构和空间群完全一样，其不可约表示的分类当然也与之无异。
故而我们不需要对它们再做进一步的讨论。

2. 第二类磁空间群

第二类磁空间群的群结构就是某个空间群$SG$和时间反演对称性$\mathbb Z_2^T$的直乘：$SG\times\mathbb Z_2^T$。
因此，第二类磁空间群也有230种。
物理上讲，它们对应于没有磁性的顺磁态的对称性，因此也不是我们想讨论的对象。

排除掉上面两类相对平庸的情形，我们真正想讨论的是$SG'=SG\times\mathbb Z_2^T$破缺时间反演不变性后得到的的非平凡子群。
它们在文献中被称为第三类和第四类磁空间群。
这样的磁空间群$MSG$中也会包含幺正和反幺正对称性，其中后者是某种空间对称性操作与时间反演的复合操作。

事实上，$MSG$中的幺正和反幺正操作正好各占一半。
为了看出这一点，我们可以引入一个标记反幺正元素的$\mathbb Z_2$分级（$\mathbb Z_2$ grading）：
我们用$s(g)=\pm1$来表示$g\in MSG$是幺正（反幺正）操作。
由于两个反幺正操作的乘积是一个幺正操作、一个幺正操作和一个反幺正操作的乘积是一个反幺正操作，我们可以验证
$s(g_1)s(g_2)=s(g_1\cdot g_2)$。
也就是说，$s:MSG\rightarrow\mathbb Z_2$是一个群同态。
对于第一类磁空间群，这个群同态$s$是平庸的，对应于所有群元素都是幺正的。
而对于其它类型的磁空间群（包括上面介绍的第二类和下面要介绍的第三类、第四类），这个群同态都是非平庸的，即$s$的象是整个$\mathbb Z_2$群。
因此，$MSG$中所有的幺正元素组成了$\ker s=s^{-1}(+1)$，它是$MSG$的一个正规子群。
由于其中包含了一些平移操作，这个正规子群也是230个空间群中的一个。
按照数学上对$\mathbb Z_2$分级的通常记号，我们将$\ker s$记作$MSG_0$。
特别地，对于第二类磁空间群$MSG=SG\times\mathbb Z_2^T$，$MSG_0$就是$SG$。
此外，$MSG$中所有的反幺正元素组成了$-1$在$s$下的原象$s^{-1}(-1)$，我们将它记作$MSG_1$。
它是$MSG / MSG_0$的（除$MSG_0$外）另一个陪集。
根据群同态的基本理论，我们知道$MSG_0$和$MSG_1$中的元素是一一对应的；
二者的并集构成了整个$MSG$群；
而$(MSG:MSG_0)=2$。

磁空间群另一个有趣的性质是，如果不考虑幺正和反幺正元素的区别，它的代数结构总是和某个空间群是一样的。
为了证明这一点，我们引入如下的一些概念：
既然$MSG_1$中所有操作都是反幺正操作，我们可以将其中每个元素再复合上时间反演$\mathcal T$，从而得到一个幺正操作。
这样，我们会得到一个仅包含幺正操作的陪集$\mathcal TMSG_1$。
接下来，我们考虑$MSG_0\cup\mathcal TMSG_1$。
容易证明，二者的并集构成一个封闭的幺正对称群$MSG'$。
由于$MSG'$中包含平移群，它一定是230个空间群中的一个。
我们注意到由于$\mathcal T$与其它的空间群操作都对易，$MSG'$与$MSG$的代数结构是一样的（也就是说二者作为群是同构的）；二者的区别仅仅体现在标记反幺正操作的$\mathbb Z_2$分级$s$的不同。
这样，我们就证明了一个磁空间群总是同构于一个空间群$MSG'$。

第三类和第四类之间的区别就在于$MSG_1$中包含的反幺正元素的种类：
对于前者，$MSG_1$中不包含纯粹的平移元素与时间反演的复合；对于后者，$MSG_1$中包含纯粹的平移元素与时间反演的复合。
因此，当恢复时间反演对称性时，第三类磁空间群的晶格原胞保持不变，而第四类磁空间群的原胞会减半。
反过来说，从高温的顺磁相进入低温的磁性长程序相时，第三类磁空间群的晶格原胞保持不变，而第四类空间群的原胞会扩大一倍。
这是对这两类磁空间群最直观的理解。
我们下面对二者分别进行讨论。

3. 第三类磁空间群

在第三类磁空间群中，$MSG_1$不包含像$\{1|\boldsymbol t\}$这样的纯粹的平移元素（与时间反演对称性的复合）。
也就是说，所有的平移操作都是$MSG_0$中的幺正操作。
如前所述，由于$MSG'$的平移群全部在$MSG_0$中，二者的布拉伐格子是完全一致的。
因此，第三类磁空间群又被称为“没有布拉伐格子的黑白群”(Black and white groups without black and white Bravais lattices)。

4. 第四类磁空间群
